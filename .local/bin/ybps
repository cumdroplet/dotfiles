#!/bin/sh

PKG_LIST="$XDG_DATA_HOME/packages"

update_pkg_list() {
	xbps-query -m |
	xargs -n1 xbps-uhelper getpkgname > "$PKG_LIST" &&
	echo "Package list updated: $PKG_LIST"
}

if [ "$1" = "update" ]; then
	update_pkg_list
	exit 0
fi

pkg=$(xbps-query -Rs "" | dmenu -i -l 20 | awk '{print $2}')

[ -z "$pkg" ] && exit 1

printf "%s" "$pkg " | xclip -selection clipboard &&
echo "Package $pkg: copied to clipboard"
